/* Hijack v1.0.0 - jQuery Plugin - Copyright (c) 2012 Jason LaFosse - Licensed under MIT and GPL */
(function(f){var e={isNull:function(a){return null===a},isUndefined:function(a){return"undefined"===typeof a},isEmpty:function(a){return""==a||e.isNull(a)||e.isUndefined(a)},isString:function(a){return"string"===typeof a},isBoolean:function(a){return"boolean"===typeof a},isNumber:function(a){return"number"===typeof a&&isFinite(a)},stringToBoolean:function(a){if(!e.isString(a))return a;switch(a.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;
default:return Boolean(a)}},executeFunctionByName:function(a,f){var b=Array.prototype.slice.call(arguments,2);1>b.length&&(b=arguments);for(var e=a.split("."),d=e.pop(),c=window,j=0;j<e.length;j++)c=c[e[j]];try{return c[d].apply(f,b)}catch(k){return alert(k),null}}},l={hrefs:!0,forms:!0,data:null,recursive:!0,canRehijack:!0,target:null,context:null,confirmHijack:function(){return!0},beforeHijack:function(){},afterHijack:function(){},onSuccess:function(a){f(this).html(a)},onError:function(a){alert("ERROR: "+
a)}};f.extend({hijackSetup:function(a){f.extend(!0,l,a)}});f.fn.hijack=function(a){var a=a||{},h=function(b,a,d){if(!e.isEmpty(b)){e.isEmpty(d)&&(d=arguments);if(f.isFunction(b))return b.apply(a,d);if(e.isString(b)){var d=b.split(","),c=d.shift();return e.executeFunctionByName(c,a,d)}}};return this.each(function(){var b=f(this),g=b.data("hijack");(e.isBoolean(g)||e.isNumber(g))&&b.data("hijack",{hrefs:g,forms:g});var d=f.extend(!0,{},a,b.data("hijack"));d.hrefs=e.stringToBoolean(d.hrefs);d.forms=
e.stringToBoolean(d.forms);b.data("hijack",d);var c=f.extend(!0,{},l,d);f("a, form",b).each(function(){d._parent=b;f(this).hijack(d)});e.isEmpty(c.target)&&(c.target=c._parent||b.parent());if(b.prop("tagName").match(/a/i))a:if(c.hrefs&&b.attr("href")&&!b.attr("href").match(/.*#$/)){if(b.data("_hijacked")){if(!c.canRehijack)break a;b.unbind("submit.hijack").data("_hijacked",!1)}b.bind("click.hijack",function(a){a.preventDefault();a=f(c.target);a=e.isEmpty(c.context)?a:f(c.context);h(c.confirmHijack,
a)&&(b.trigger("beforeHijack"),h(c.beforeHijack,a,[c]),f.ajax({url:this.href,data:c.data,success:function(a,d,g){e.isEmpty(a.error)?(h(c.onSuccess,this,[a,d,g]),c.recursive&&f(this).hijack(c)):h(c.onError,this,[a,d,g]);b.trigger("afterHijack");h(c.afterHijack,this,[a])},context:a}))}).data("_hijacked",!0)}if(b.prop("tagName").match(/form/i))a:if(c.forms){if(b.data("_hijacked")){if(!c.canRehijack)break a;b.unbind("submit.hijack").data("_hijacked",!1)}var j=b.get(0);for(i=0;i<j.attributes.length;i++)if(j.attributes[i].specified){var g=
j.attributes[i].nodeName.toString().toLowerCase(),k=g.match(/^on([a-z]+)/);if(!e.isEmpty(k)){var k=k[1],m=new Function(j.attributes[i].nodeValue.toString());b.removeAttr(g);b.bind(k,m);g=b.data("events")[k];g.unshift(g.pop());b.data("events")[k]=g}}b.bind("submit.hijack",function(a){a.preventDefault();if(!e.isBoolean(a.result)||a.result)if(a=f(c.target),a=e.isEmpty(c.context)?a:f(c.context),h(c.confirmHijack,a))return b.trigger("beforeHijack"),h(c.beforeHijack,a,[c]),f.ajax({url:j.action,data:b.serialize()+
"&"+f.param(c.data),success:function(a,d,g){e.isEmpty(a.error)?(h(c.onSuccess,this,[a,d,g]),c.recursive&&f(this).hijack(c)):h(c.onError,this,[a,d,g]);b.trigger("afterHijack");h(c.afterHijack,this,[a])},context:a}),!1}).data("_hijacked",!0)}})}})(jQuery);